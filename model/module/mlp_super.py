def spatial_shift1(x):
    B,H,W,C = x.size()
    x[:,1:,:,:C//4] = x[:,:H-1,:,:C//4]
    x[:,:H-1,:,C//4:C//2] = x[:,1:,:,C//4:C//2]
    x[:,:,1:,C//2:C * 3//4] = x[:,:,:W-1,C//2:C * 3//4]
    x[:,:,:W-1,3 * C//4:] = x[:,:,1:,3 * C//4:]

    return x

def spatial_shift2(x):
    B,H,W,C = x.size()
    x[:,:,1:,:C//4] = x[:,:,:W-1,:C//4]
    x[:,:,:W-1,C//4:C//2] = x[:,:,1:,C//4:C//2]
    x[:,1:,:,C//2:C * 3//4] = x[:,:H-1,:,C//2:C * 3//4]
    x[:,:H-1,:,3 * C//4:] = x[:,1:,:,3 * C//4:]
    return x